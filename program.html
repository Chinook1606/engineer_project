<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Pomiar ciepła właściwego</title>
    <link rel="stylesheet" href="assets/styles/main.css" />
    <link rel="stylesheet" href="assets/styles/program.css" />
    <link rel="stylesheet" href="assets/styles/fonts.css" />
    <link rel="stylesheet" href="assets/templates/navbar/navbar.css" />
    <link rel="stylesheet" href="assets/templates/footer/footer.css" />
    <script defer src="assets/js/templates-importer.js"></script>
    <script src="assets/templates/navbar/navbar.js"></script>
    <script id="MathJax-script" async
      src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.4.0/jspdf.umd.min.js"></script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.23/jspdf.plugin.autotable.min.js"></script>
    <script>

      function centeredText(doc, text, y) {
        var textWidth =
          (doc.getStringUnitWidth(text) * doc.internal.getFontSize()) /
          doc.internal.scaleFactor;
        var textOffset = (doc.internal.pageSize.width - textWidth) / 2;
        doc.text(text, textOffset, y);
}
      function calculate() {
          event.preventDefault(); 

          const mk = document.getElementsByName("mk")[0];
          const mkw = document.getElementsByName("mkw")[0];
          const mcst = document.getElementsByName("mcst")[0]; // nie znamy masy własnej obiektu, więc trzeba ją podać, do wyjaśnienia

          const t1 = document.getElementsByName("t1")[0];
          const t2 = document.getElementsByName("t2")[0];
          const t3 = document.getElementsByName("t3")[0];

          const q1 = document.getElementsByName("q1")[0];
          const q2 = document.getElementsByName("q2")[0];
          const q3 = document.getElementsByName("q3")[0];


          
          const cwal = document.getElementsByName("cwal")[0];
          cwal.value = 1029;
          const cwh2o = document.getElementsByName("cwh2o")[0];
          cwh2o.value = 4190;
          const cwst = document.getElementsByName("cwst")[0];

          q1.value = parseInt(parseFloat(mk.value) *  parseFloat(cwal.value) * (parseFloat(t3.value) - parseFloat(t1.value)));
          q2.value = parseInt((parseFloat(mkw.value)-parseFloat(mk.value)) * parseFloat(cwh2o.value) * (parseFloat(t3.value)-parseFloat(t1.value)));
          q3.value = parseInt(parseFloat(q1.value) + parseFloat(q2.value));
          cwst.value = parseInt((parseFloat(q3.value))/(parseFloat(mcst.value)*(parseFloat(t2.value)-parseFloat(t3.value))));

          document.getElementById("exportButton").style.display = "block";
      }

      function showExportOptions() {
        document.getElementById("exportOptions").style.display = "block";
        showExportOptions1();
        showExportOptions2();
    }
    function showExportOptions1() {
        document.getElementById("exportOptions1").style.display = "block";
    }
    function showExportOptions2() {
        document.getElementById("exportOptions2").style.display = "block";
    }

    function saveToPDF() {
      const description = document.getElementById("description").value;
      const imie = document.getElementById("imie").value;
      const nazwisko = document.getElementById("nazwisko").value;
      const przedmiot = document.getElementById("przedmiot").value;
      const nr_indeksu = document.getElementById("nr_indeksu").value;
      const kierunek = document.getElementById("kierunek").value;
      const nr_lab = document.getElementById("nr_lab").value;
      const tytul = document.getElementById("tytul").value;


      // Utwórz PDF
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();
      doc.setFont("times");
      // Pierwsza strona - Wyśrodkowany tytuł wielkimi literami
      doc.setFontSize(32);
      doc.setFont("times", "bold");
      centeredText(doc, "UNIWERSYTET", 45);
      centeredText(doc, "KOMISJI  EDUKACJI  NARODOWEJ", 60);
      centeredText(doc, "W  KRAKOWIE", 75);
      doc.setFont("times", "normal");
      doc.setFontSize(16);
      centeredText(doc, `${przedmiot}`, 95);

      // Tutaj wstaw obraz logo (wyśrodkowany)
      var imgData; // Tu powinien być ciąg base64 obrazu logo
      var imgWidth = 80; // Szerokość obrazu w mm
      var imgHeight = 40; // Wysokość obrazu w mm
      var x = doc.internal.pageSize.width / 2 - imgWidth / 2;
      var y = 80; // Wysokość, na której powinno być logo
      // doc.addImage(imgData, 'PNG', x, y, imgWidth, imgHeight);
      doc.addImage("assets/images/pdf/uken_logo.png", "PNG", 25, 90, 160, 95);

      doc.setFontSize(18);
      doc.setFont("times", "bold");
      centeredText(doc, "Laboratorium 4", 182);
      doc.setFont("times", "normal");
      centeredText(doc, "Oscylator harmoniczny", 195);

      // Informacje o autorze
      const pageInfo = doc.internal.pageSize;
      const pageHeight = pageInfo.height ? pageInfo.height : pageInfo.getHeight();
      doc.setFontSize(12);
      doc.text("Wykonał:", pageInfo.width - 70, pageHeight - 30);
      doc.text(`${imie}`, pageInfo.width - 70, pageHeight - 20);
      doc.text("Informatyka IV rok", pageInfo.width - 70, pageHeight - 10);
      doc.text("nr. 151932", pageInfo.width - 70, pageHeight);

      // Dodaj drugą stronę
      doc.addPage();

      // Druga strona - Dane
      doc.setFontSize(16);
      centeredText(doc, "Wyniki eksportu:", 20);

      doc.setFontSize(14);
      centeredText(doc, `Suma: ${imie}`, 40);
      centeredText(doc, `Imię: jan`, 50);
      centeredText(doc, `Nazwisko: ${imie}`, 60);

      doc.autoTable({
        startY: 70,
        head: [["Kolumna 1", "Kolumna 2", "Kolumna 3"]],
        body: [
          ["Dane 1.1", "Dane 1.2", "Dane 1.3"],
          ["Dane 2.1", "Dane 2.2", "Dane 2.3"],
        ],
      });

      // Dodaj trzecią stronę z opisem
      doc.addPage();

      // Ustawienia czcionki dla opisu
      doc.setFont("times", "normal");
      doc.setFontSize(12);

      // Ustawienie marginesów
      const margins = {
        top: 20,
        bottom: 20,
        left: 20,
        width: 170,
      };

      // Dodaj tekst opisu z zawijaniem do nowej linii
      doc.text(description, margins.left, margins.top, {
        maxWidth: margins.width,
        align: "justify",
      });

      // Zapisz PDF
      doc.save("sprawozdanie.pdf");
}

      </script>
  </head>
  <body>

    <div class="container">
      <div id="navbar-placeholder"></div>

      <div class="banner page">
        <div class="bannerOverlay page"></div>
        <section class="bannerLeft">
          <h2>Program</h2>
          <h3>Zmierz ciepło właściwe ciała stałego</h3>
        </section>
        <section class="bannerRight">
          <p>Wprowadź do formularza potrzebne dane a następnie kliknij przcisk oblicz.</p>
        </section>
      </div>

      <div class="container">
        <section class="content">
          <form onsubmit="return calculate();">
            <div class="form-div">
              <div class="top">Masa</div>
              <div class="bottom">
                <div class="bottom-cont">
                  <div>Kalorymetru \(m_k\)</div>
                  <div>
                    <input type="text" name="mk">
                    <span>kg</span>
                  </div>
                </div>
                <div class="bottom-cont">
                  <div>Kalorymetru z wodą \(m_{k+w}\)</div>
                  <div>
                    <input type="text" name="mkw">
                    <span>kg</span>
                  </div>
                </div>
                <div class="bottom-cont">
                  <div>Ciała stałego \(m_{cst}\)</div>
                  <div>
                    <input type="text" name="mcst">
                    <span>kg</span></div>
                </div>
              </div>
            </div>

            <div class="form-div">
              <div class="top">Temperatura</div>
              <div class="bottom">
                <div class="bottom-cont">
                  <div>Początkowa wody \(t_1\)</div>
                  <div>
                    <input type="text" name="t1">
                    <span>℃</span>
                  </div>
                </div>
                <div class="bottom-cont">
                  <div>Ciała stałego \(t_2\)</div>
                  <div>
                    <input type="text" name="t2">
                    <span>℃</span>
                  </div>
                </div>
                <div class="bottom-cont">
                  <div>Końcowa wody \(t_3\)</div>
                  <div>
                    <input type="text" name="t3">
                    <span>℃</span>
                  </div>
                </div>
              </div>
            </div>

            <input class="submit-btn" type="submit" value="Oblicz">

            <div class="form-div">
              <div class="top">Ciepło</div>
              <div class="bottom">
                <div class="bottom-cont">
                  <div>Pobrane przez kalorymetr \(Q_1\)</div>
                  <div>
                    <input disabled type="text" name="q1">
                    <span>J</span>
                  </div>
                </div>
                <div class="bottom-cont">
                  <div>Pobrane przez wodę \(Q_2\)</div>
                  <div>
                    <input disabled type="text" name="q2">
                    <span>J</span>
                  </div>
                </div>
                <div class="bottom-cont">
                  <div>Oddane przez ciało stałe \(Q_3\)</div>
                  <div>
                    <input disabled type="text" name="q3">
                    <span>J</span></div>
                </div>
              </div>
            </div>

            <div class="form-div">
              <div class="top">Ciepło właściwe</div>
              <div class="bottom">
                <div class="bottom-cont">
                  <div>Kalorymetru \(c_{wAl}\)</div>
                  <div>
                    <input class="tex" disabled type="text" name="cwal">
                    <span class="tex">\(\frac{J}{kg\cdot K}\)</span>
                  </div>
                </div>
                <div class="bottom-cont">
                  <div>Wody \(c_{wH2O}\)</div>
                  <div>
                    <input class="tex" disabled type="text" name="cwh2o">
                    <span class="tex">\(\frac{J}{kg\cdot K}\)</span>
                  </div>
                </div>
                <div class="bottom-cont">
                  <div>Ciała stałego \(c_{wcst}\)</div>
                  <div>
                    <input class="tex" disabled type="text" name="cwst">
                    <span class="tex">\(\frac{J}{kg\cdot K}\)</span>
                  </div>
                </div>
              </div>
            </div><br>
            <!-- Sekcja po kliknięciu przycisku Oblicz  -->
            <input id="exportButton" class="submit-btn" type="button" value="Eksportuj"
              onclick="showExportOptions()" style="display:none;">

            <!-- Sekcja informacji ogólnych -->
            <div class="form-div" id="exportOptions" style="display:none;">
              <div class="top">Informacje ogólne</div>
              <div class="bottom">
                <div class="bottom-cont">
                  <div>Nazwa przedmiotu</div>
                  <div>
                    <input class="tex" type="text" id="przedmiot"
                      placeholder="Pozostaw puste jeśli nie dotyczy.">
                  </div>
                </div>
              </div>
              <div class="bottom">
                <div class="bottom-cont">
                  <div>Numer laboratorium</div>
                  <div>
                    <input class="tex" type="text" id="nr_lab">
                  </div>
                </div>
                <div class="bottom-cont">
                  <div>Tytuł laboratorium</div>
                  <div>
                    <input class="tex" type="text" id="tytul"
                      placeholder="Pozostaw puste jeśli nie dotyczy.">
                  </div>
                </div>
              </div>
              <div class="dashed-line"></div>
              <div class="bottom">
                <div class="bottom-cont">
                  <div>Imie</div>
                  <div>
                    <input class="tex" type="text" id="imie">
                  </div>
                </div>
                <div class="bottom-cont">
                  <div>Nazwisko</div>
                  <div>
                    <input class="tex" type="text" id="nazwisko">
                  </div>
                </div>
              </div>
              <div class="bottom">
                <div class="bottom-cont">
                  <div>Kierunek</div>
                  <div>
                    <input class="tex" type="text" id="kierunek"
                      placeholder="Pozostaw puste jeśli nie dotyczy.">
                  </div>
                </div>
                <div class="bottom-cont">
                  <div>Numer indeksu</div>
                  <div>
                    <input class="tex" type="text" id="nr_indeksu"
                      placeholder="Pozostaw puste jeśli nie dotyczy.">
                  </div>
                </div>
              </div>
            </div>
            <!-- Sekcja informacji ogólnych -->
            <div class="form-div" id="exportOptions1" style="display:none;">
              <div class="top">Wnioski</div>
              <div class="bottom">
                <div class="bottom-cont">
                  <div>
                    <textarea class="tex" type="text" id="description"
                      placeholder="Miejsce na wypisanie wniosków z laboratorium."
                      style="width: 100%; height: 10em;"></textarea>
                  </div>
                </div>
              </div>
            </div>

            <!-- Pobieranie PDF'a  -->
            <input class="submit-btn" id="exportOptions2" type="button" value="Zapisz do PDF"
              onclick="saveToPDF()" style="display:none;">
            <!-- Sekcja z wnioskami  -->

          </form>

        </section>

      </div>

      <div id="footer-placeholder"></div>
    </div>
  </body>
</html>
